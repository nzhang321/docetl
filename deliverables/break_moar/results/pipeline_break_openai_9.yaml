datasets:
  transcripts:
    path: C:\Users\nickz\cuhk_app\docetl\data_sample.json
    type: file
default_model: openai/gpt-5-nano
bypass_cache: true
operations:
- name: extract_place_names_parallel
  type: parallel_map
  litellm_completion_kwargs:
    temperature: 0
  prompts:
  - name: extract_place_names_core
    output_keys:
    - subtask_1_output
    prompt: 'Extract all place names mentioned by speakers in the following transcript
      text. Include cities, states, countries, regions, well-known landmarks, and
      political jurisdictions. Return a JSON array of distinct place name strings
      (preserve original capitalization and common punctuation) and do not include
      non-place tokens or speaker names. Transcript: {{ input.content }}'
  output:
    schema:
      subtask_1_output: string
  model: openai/gpt-5-nano
- name: extract_place_names_aggregate
  type: map
  prompt: 'The subtask produced the following list of place names: {{ input.subtask_1_output
    }}. Return the final output matching the original schema: a single field named
    place_names containing the list {{ input.subtask_1_output }}.'
  litellm_completion_kwargs:
    temperature: 0
  output:
    schema:
      place_names: list[str]
  model: openai/gpt-5-nano
pipeline:
  steps:
  - name: extract_place_names
    input: transcripts
    operations:
    - extract_place_names_parallel
    - extract_place_names_aggregate
  output:
    type: file
    path: C:\Users\nickz\cuhk_app\docetl\results\moar_optimization\results\pipeline_break_openai_9.json
optimizer_config:
  type: moar
  save_dir: results/moar_optimization/results
  available_models:
  - openai/gpt-5-mini
  - openai/gpt-5-nano
  evaluation_file: evaluate_place_names.py
  metric_key: place_name_extraction_score
  max_iterations: 10
  rewrite_agent_model: openai/gpt-5-mini
  model: openai/gpt-5-mini
rate_limits:
  llm_call:
  - count: 500
    per: 1
    unit: minute
  llm_tokens:
  - count: 500000
    per: 1
    unit: minute
